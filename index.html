<script>
  const supabaseUrl = "https://ifoluumtfnkhszhnhveu.supabase.co";
  const supabaseKey = "sb_publishable_Q6bzxDdjaaQGsF_JDkSJCA_6IDUyuzT";
  const supabase = supabase.createClient(supabaseUrl, supabaseKey);

  async function verify() {
    const params = new URLSearchParams(window.location.search);
    const code = params.get("code");

    if (!code) {
      document.getElementById("card").innerHTML = `
        <h2>❌ Invalid verification link</h2>
        <p>Missing verification code.</p>
      `;
      return;
    }

    const { error } = await supabase.auth.exchangeCodeForSession(code);

    if (error) {
      document.getElementById("card").innerHTML = `
        <h2>❌ Verification failed</h2>
        <p>${error.message}</p>
      `;
      return;
    }

    document.getElementById("card").innerHTML = `
      <h2>✅ Email verified</h2>
      <p>You may now return to the SafeCall app.</p>
    `;
  }

  verify();
</script>
